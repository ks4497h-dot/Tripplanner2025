<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Osaka Trip Planner</title>
    <!-- Tailwind Play CDN (í”„ë¡œë•ì…˜ ì•ˆì „, ê²½ê³  ì—†ìŒ) -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
    <script>
      tailwind.config = {
        theme: { extend: { colors: { rose: { 600: '#dc2626' } } } }
      };
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>body { font-family: 'Inter', sans-serif; background: #f8fafc; }</style>
  </head>
  <body>
    <div id="root">ë¡œë”© ì¤‘... (ì½˜ì†” ì—ëŸ¬ í™•ì¸í•˜ì„¸ìš”)</div>

    <script>
      // CDN ìˆœì°¨ ë¡œë“œ (ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™”)
      function loadScript(src, callback, onerror = null) {
        const script = document.createElement('script');
        script.src = src;
        script.onload = callback;
        if (onerror) script.onerror = onerror;
        document.head.appendChild(script);
      }

      loadScript('https://unpkg.com/react@18/umd/react.production.min.js', () => {
        loadScript('https://unpkg.com/react-dom@18/umd/react-dom.production.min.js', () => {
          // ìµœì‹  UMD CDN (0.24.1, 2025ë…„ ê¸°ì¤€ ì•ˆì •)
          loadScript('https://unpkg.com/@google/generative-ai@0.24.1/dist/index.umd.js', initApp, () => {
            document.getElementById('root').innerHTML = '<p>AI ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì‹¤íŒ¨. ìƒˆë¡œê³ ì¹¨ í•´ë³´ì„¸ìš”. (ì½˜ì†” F12 í™•ì¸)</p>';
          });
        });
      });

      function initApp() {
        if (typeof React === 'undefined' || typeof google === 'undefined') {
          document.getElementById('root').innerHTML = '<p>React ë˜ëŠ” AI ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì‹¤íŒ¨. ì½˜ì†” í™•ì¸ (F12).</p>';
          return;
        }

        const { useState } = React;
        const { createRoot } = ReactDOM;
        const { GoogleGenerativeAI } = google.generativeAI;

        // API í‚¤ (Vercel Envì—ì„œ ìë™ ì¹˜í™˜ë¨)
        const API_KEY = import.meta.env ? import.meta.env.VITE_GEMINI_API_KEY : 'YOUR_API_KEY_HERE';

        function App() {
          const [days, setDays] = useState("3");
          const [people, setPeople] = useState("2");
          const [budget, setBudget] = useState("100ë§Œì›");
          const [loading, setLoading] = useState(false);
          const [result, setResult] = useState("");

          const generate = async () => {
            if (!API_KEY || API_KEY === 'YOUR_API_KEY_HERE') {
              setResult("âŒ Gemini API í‚¤ë¥¼ Vercel Environment Variablesì— ì¶”ê°€í•´ì£¼ì„¸ìš”! (Name: VITE_GEMINI_API_KEY, Value: AIzaSy...)");
              return;
            }

            setLoading(true);
            setResult("ğŸ¤– AIê°€ ì˜¤ì‚¬ì¹´ ì—¬í–‰ ì¼ì • ìƒì„± ì¤‘... (10-30ì´ˆ ì†Œìš”)");

            try {
              const genAI = new GoogleGenerativeAI(API_KEY);
              const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });

              const prompt = `ì˜¤ì‚¬ì¹´ ${days}ì¼ ì—¬í–‰ ì¼ì • ë§Œë“¤ì–´ì¤˜. ì¸ì› ${people}ëª…, ì˜ˆì‚° ${budget}. 
              ë§›ì§‘ ìœ„ì£¼ë¡œ, ì´ë™ ê²½ë¡œ íš¨ìœ¨ì ìœ¼ë¡œ, í•œêµ­ì–´ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ì‘ì„±í•´ì¤˜. 
              ë‚ ì§œë³„ë¡œ ì œëª© ë‹¬ê³  ì•„ì¹¨/ì ì‹¬/ì €ë…/ê°„ì‹/ì•¼ê²½ê¹Œì§€ ìƒì„¸íˆ!`;

              const res = await model.generateContent(prompt);
              setResult(res.response.text());
            } catch (e) {
              setResult("âŒ ì˜¤ë¥˜: " + (e.message || 'API í‚¤ë‚˜ ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•˜ì„¸ìš”.'));
              console.error('AI ìƒì„± ì˜¤ë¥˜:', e);
            }
            setLoading(false);
          };

          // React.createElementë¡œ UI (JSX ì—ëŸ¬ ë°©ì§€)
          const inputStyle = 'w-full px-5 py-4 rounded-xl border border-gray-300 focus:border-rose-400 focus:outline-none';
          const buttonStyle = 'w-full bg-rose-600 hover:bg-rose-700 text-white font-bold py-5 rounded-xl disabled:opacity-50 transition-colors';
          const resultStyle = 'mt-8 p-6 bg-rose-50 rounded-xl whitespace-pre-wrap text-sm leading-relaxed border border-rose-100';

          return React.createElement('div', { className: 'min-h-screen p-6 max-w-2xl mx-auto' },
            React.createElement('h1', { className: 'text-4xl font-bold text-center mb-2 text-rose-600' }, 'Osaka Trip Planner'),
            React.createElement('p', { className: 'text-center text-gray-600 mb-10' }, 'AIê°€ ë§Œë“¤ì–´ì£¼ëŠ” ìµœê³ ì˜ ì˜¤ì‚¬ì¹´ ì—¬í–‰ ì¼ì •'),
            React.createElement('div', { className: 'bg-white rounded-2xl shadow-xl p-8 space-y-6' },
              React.createElement('input', {
                placeholder: 'ëª‡ ë°• ëª‡ ì¼?',
                value: days,
                onChange: e => setDays(e.target.value),
                className: inputStyle
              }),
              React.createElement('input', {
                placeholder: 'ì¸ì› ìˆ˜',
                value: people,
                onChange: e => setPeople(e.target.value),
                className: inputStyle
              }),
              React.createElement('input', {
                placeholder: 'ì˜ˆì‚° (ì˜ˆ: 100ë§Œì›)',
                value: budget,
                onChange: e => setBudget(e.target.value),
                className: inputStyle
              }),
              React.createElement('button', {
                onClick: generate,
                disabled: loading,
                className: buttonStyle
              }, loading ? 'ìƒì„± ì¤‘...' : 'ì—¬í–‰ ì¼ì • ë§Œë“¤ì–´ì¤˜!'),
              result ? React.createElement('div', { className: resultStyle }, result) : null
            )
          );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
      }
    </script>
  </body>
</html>
