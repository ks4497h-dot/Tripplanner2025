<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Osaka Trip Planner</title>
    <!-- Tailwind Play CDN (í”„ë¡œë•ì…˜ ì•ˆì „, ê²½ê³  ì—†ìŒ) -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>body { font-family: 'Inter', sans-serif; background: #f8fafc; }</style>
    <!-- ESM Import Map for ìµœì‹  Gemini SDK -->
    <script type="importmap">
      {
        "imports": {
          "react": "https://esm.sh/react@18",
          "react-dom": "https://esm.sh/react-dom@18",
          "@google/genai": "https://unpkg.com/@google/genai@1.30.0/dist/index.mjs"
        }
      }
    </script>
  </head>
  <body>
    <div id="root">ë¡œë”© ì¤‘... (ì½˜ì†” ì—ëŸ¬ í™•ì¸í•˜ì„¸ìš”)</div>

    <script type="module">
      // ë™ì  importë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ (ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™”)
      async function loadLibs() {
        try {
          const { useState } = await import('react');
          const { createRoot } = await import('react-dom/client');
          const { GoogleGenerativeAI } = await import('@google/genai');

          const API_KEY = import.meta.env.VITE_GEMINI_API_KEY || 'YOUR_API_KEY_HERE';

          function App() {
            const [days, setDays] = useState("3");
            const [people, setPeople] = useState("2");
            const [budget, setBudget] = useState("100ë§Œì›");
            const [loading, setLoading] = useState(false);
            const [result, setResult] = useState("");

            const generate = async () => {
              if (!API_KEY || API_KEY === 'YOUR_API_KEY_HERE') {
                setResult("âŒ Gemini API í‚¤ë¥¼ Vercel Environment Variablesì— ì¶”ê°€í•´ì£¼ì„¸ìš”! (VITE_GEMINI_API_KEY = AIzaSy...)");
                return;
              }

              setLoading(true);
              setResult("ğŸ¤– AIê°€ ì˜¤ì‚¬ì¹´ ì—¬í–‰ ì¼ì • ìƒì„± ì¤‘... (10-30ì´ˆ ì†Œìš”)");

              try {
                const genAI = new GoogleGenerativeAI(API_KEY);
                const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });

                const prompt = `ì˜¤ì‚¬ì¹´ ${days}ì¼ ì—¬í–‰ ì¼ì • ë§Œë“¤ì–´ì¤˜. ì¸ì› ${people}ëª…, ì˜ˆì‚° ${budget}. 
                ë§›ì§‘ ìœ„ì£¼ë¡œ, ì´ë™ ê²½ë¡œ íš¨ìœ¨ì ìœ¼ë¡œ, í•œêµ­ì–´ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ì‘ì„±í•´ì¤˜. 
                ë‚ ì§œë³„ë¡œ ì œëª© ë‹¬ê³  ì•„ì¹¨/ì ì‹¬/ì €ë…/ê°„ì‹/ì•¼ê²½ê¹Œì§€ ìƒì„¸íˆ!`;

                const res = await model.generateContent(prompt);
                setResult(res.response.text());
              } catch (e) {
                setResult("âŒ ì˜¤ë¥˜: " + (e.message || 'API í‚¤ë‚˜ ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•˜ì„¸ìš”.'));
                console.error('AI ìƒì„± ì˜¤ë¥˜:', e);
              }
              setLoading(false);
            };

            return (
              <div className="min-h-screen p-6 max-w-2xl mx-auto">
                <h1 className="text-4xl font-bold text-center mb-2 text-rose-600">Osaka Trip Planner</h1>
                <p className="text-center text-gray-600 mb-10">AIê°€ ë§Œë“¤ì–´ì£¼ëŠ” ìµœê³ ì˜ ì˜¤ì‚¬ì¹´ ì—¬í–‰ ì¼ì •</p>
                <div className="bg-white rounded-2xl shadow-xl p-8 space-y-6">
                  <input
                    placeholder="ëª‡ ë°• ëª‡ ì¼?"
                    value={days}
                    onChange={e => setDays(e.target.value)}
                    className="w-full px-5 py-4 rounded-xl border border-gray-300 focus:border-rose-400 focus:outline-none"
                  />
                  <input
                    placeholder="ì¸ì› ìˆ˜"
                    value={people}
                    onChange={e => setPeople(e.target.value)}
                    className="w-full px-5 py-4 rounded-xl border border-gray-300 focus:border-rose-400 focus:outline-none"
                  />
                  <input
                    placeholder="ì˜ˆì‚° (ì˜ˆ: 100ë§Œì›)"
                    value={budget}
                    onChange={e => setBudget(e.target.value)}
                    className="w-full px-5 py-4 rounded-xl border border-gray-300 focus:border-rose-400 focus:outline-none"
                  />
                  <button
                    onClick={generate}
                    disabled={loading}
                    className="w-full bg-rose-600 hover:bg-rose-700 text-white font-bold py-5 rounded-xl disabled:opacity-50 transition-colors"
                  >
                    {loading ? 'ìƒì„± ì¤‘...' : 'ì—¬í–‰ ì¼ì • ë§Œë“¤ì–´ì¤˜!'}
                  </button>
                  {result && (
                    <div className="mt-8 p-6 bg-rose-50 rounded-xl whitespace-pre-wrap text-sm leading-relaxed border border-rose-100">
                      {result}
                    </div>
                  )}
                </div>
              </div>
            );
          }

          const root = createRoot(document.getElementById('root'));
          root.render(<App />);
        } catch (error) {
          console.error('ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì‹¤íŒ¨:', error);
          document.getElementById('root').innerHTML = '<p>ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì˜¤ë¥˜. ìƒˆë¡œê³ ì¹¨ í•´ë³´ì„¸ìš”. (ì½˜ì†” í™•ì¸)</p>';
        }
      }

      loadLibs();
    </script>
  </body>
</html>
